{"version":3,"file":"toggle-preview-access-sharing.cjs","sources":["../src/togglePreviewAccessSharing.ts"],"sourcesContent":["import type {SanityClient} from '@sanity/client'\nimport {schemaIdSingleton as _id, schemaTypeSingleton as _type, apiVersion, tag} from './constants'\nimport {generateUrlSecret} from './generateSecret'\nimport type {SanityClientLike} from './types'\n\n/** @internal */\nexport async function enablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<{secret: string}> {\n  const client = _client.withConfig({apiVersion})\n  const newSecret = generateUrlSecret()\n  const patch = client.patch(_id).set({secret: newSecret, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n\n  return {secret: newSecret}\n}\n\n/** @internal */\nexport async function disablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<void> {\n  const client = _client.withConfig({apiVersion})\n  const patch = client.patch(_id).set({secret: null, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n}\n\nexport type {SanityClientLike}\n"],"names":["apiVersion","generateUrlSecret","_id","_type","tag"],"mappings":";;;AAMA,eAAsB,2BACpB,SACA,QACA,WACA,QAC2B;AACrB,QAAA,SAAS,QAAQ,WAAW,EAAA,YAACA,sBAAW,GACxC,YAAYC,eAAAA,qBACZ,QAAQ,OAAO,MAAMC,UAAG,iBAAA,EAAE,IAAI,EAAC,QAAQ,WAAW,WAAW,QAAO;AACpE,SAAA,MAAA,OACH,cACA,kBAAkB,EAAA,KAACA,6BAAKC,OAAAA,UAAAA,qBAAO,QAAQ,WAAW,OAAO,CAAA,EACzD,MAAM,KAAK,EACX,OAAO,EAACC,KAAAA,UAAAA,KAAI,GAER,EAAC,QAAQ,UAAS;AAC3B;AAGA,eAAsB,4BACpB,SACA,QACA,WACA,QACe;AACf,QAAM,SAAS,QAAQ,WAAW,EAACJ,YAAAA,UAAAA,WAAW,CAAA,GACxC,QAAQ,OAAO,MAAME,UAAG,iBAAA,EAAE,IAAI,EAAC,QAAQ,MAAM,WAAW,QAAO;AACrE,QAAM,OACH,YAAY,EACZ,kBAAkB,EAACA,KAAAA,UAAAA,mBAAKC,OAAAA,UAAAA,qBAAO,QAAQ,WAAW,OAAM,CAAC,EACzD,MAAM,KAAK,EACX,OAAO,EAACC,KAAAA,UAAAA,KAAI;AACjB;;;"}